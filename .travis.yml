language: node_js
node_js:
  - "0.12"
install:
  - npm install
  - npm run pkg
after_success:
  - git config --global user.email "builds@travis-ci.com"
  - git config --global user.name "Travis CI"
  - export GIT_TAG=build-$TRAVIS_BRANCH-$(date -u "+%Y-%m-%d")-$TRAVIS_BUILD_NUMBER
  - echo -n $GIT_TAG > public/version
  - npm version patch
  - git commit -m $GIT_TAG
  #push
  - chmod 600 .travis/deploy_key.pem # this key should have push access
  - ssh-add .travis/deploy_key.pem
  - git push origin master
# whitelist
branches:
  only:
    - master